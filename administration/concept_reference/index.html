
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../../images/leaf.svg">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-7.1.1">
    
    
      
        <title>Concept Reference - Leaf Docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.9299cb39.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.ef6f36e2.min.css">
        
          
          
          <meta name="theme-color" content="#009485">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="teal" data-md-color-accent="blue">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#concept-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Leaf Docs" class="md-header__button md-logo" aria-label="Leaf Docs" data-md-component="logo">
      
  <img src="../../images/leaf.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Leaf Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Concept Reference
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/uwrit/leaf" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Leaf
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      What is Leaf?
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../installation/" class="md-tabs__link">
        Installation
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../development_and_testing/" class="md-tabs__link">
        Development and Testing
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../" class="md-tabs__link md-tabs__link--active">
        Administration
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../faqs_and_troubleshooting/" class="md-tabs__link">
        FAQs and Troubleshooting
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../showcase/" class="md-tabs__link">
        Showcase
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../about/" class="md-tabs__link">
        About
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Leaf Docs" class="md-nav__button md-logo" aria-label="Leaf Docs" data-md-component="logo">
      
  <img src="../../images/leaf.svg" alt="logo">

    </a>
    Leaf Docs
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/uwrit/leaf" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Leaf
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        What is Leaf?
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      <label class="md-nav__link" for="__nav_2">
        Installation
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Installation" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Installation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/" class="md-nav__link">
        Architecture
      </a>
    </li>
  

          
            
  
  
  
    
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_2" type="checkbox" id="__nav_2_2" >
      
      <label class="md-nav__link" for="__nav_2_2">
        Installation steps
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Installation steps" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          Installation steps
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/installation_steps/1_app_db/" class="md-nav__link">
        1 - Create App Database
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/installation_steps/2_app_server/" class="md-nav__link">
        2 - Configure App Server
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/installation_steps/3_jwt/" class="md-nav__link">
        3 - Create a JWT Signing Key
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/installation_steps/4_compile_api/" class="md-nav__link">
        4 - Compile the Leaf API
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/installation_steps/5_compile_client/" class="md-nav__link">
        5 - Build the Leaf Client
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/installation_steps/6_appsettings/" class="md-nav__link">
        6 - Configure the appsettings file
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/installation_steps/7_env/" class="md-nav__link">
        7 - Set Environment Variables
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/installation_steps/8a_configure_apache/" class="md-nav__link">
        8a - Configure Leaf with Apache
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/installation_steps/8b_configure_iis/" class="md-nav__link">
        8b - Configure Leaf with IIS
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../installation/installation_steps/9_saml2/" class="md-nav__link">
        9 - Configure Authentication with SAML2
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        Development and Testing
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Development and Testing" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Development and Testing
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../development_and_testing/" class="md-nav__link">
        Development and Testing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../development_and_testing/development/" class="md-nav__link">
        Running Leaf as a Developer
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../development_and_testing/testing/" class="md-nav__link">
        Testing Leaf
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      <label class="md-nav__link" for="__nav_4">
        Administration
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Administration" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Administration
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Administration
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Concept Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Concept Reference
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#name-subtext-and-full-text" class="md-nav__link">
    Name, Subtext, and Full Text
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tooltips" class="md-nav__link">
    Tooltips
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#patient-count" class="md-nav__link">
    Patient Count
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#numeric-filters" class="md-nav__link">
    Numeric Filters
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adding-dropdowns" class="md-nav__link">
    Adding Dropdowns
  </a>
  
    <nav class="md-nav" aria-label="Adding Dropdowns">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#problem-1" class="md-nav__link">
    Problem 1
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#problem-2" class="md-nav__link">
    Problem 2
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dropdowns-to-the-rescue" class="md-nav__link">
    Dropdowns to the Rescue
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#creating-dropdowns" class="md-nav__link">
    Creating Dropdowns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enabling-dropdowns-for-a-concept" class="md-nav__link">
    Enabling Dropdowns for a Concept
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#restricting-access" class="md-nav__link">
    Restricting Access
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#universal-ids" class="md-nav__link">
    Universal IDs
  </a>
  
    <nav class="md-nav" aria-label="Universal IDs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mapping-universalids-at-query-execution" class="md-nav__link">
    Mapping UniversalIds at Query Execution
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#naming-conventions" class="md-nav__link">
    Naming Conventions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#univeral-ids-in-dropdowns" class="md-nav__link">
    Univeral IDs in dropdowns
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#concepts-without-universal-ids" class="md-nav__link">
    Concepts without Universal IDs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-concepts-by-sql-scripts" class="md-nav__link">
    Creating Concepts by SQL Scripts
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/" class="md-nav__link">
        The Building Blocks of Leaf: Concepts
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../dataset_template_reference/" class="md-nav__link">
        Dataset Templates Reference
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../datasets/" class="md-nav__link">
        Extracting Data for a Cohort: Datasets
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../federation/" class="md-nav__link">
        Networking Multiple Leaf instances
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      <label class="md-nav__link" for="__nav_5">
        FAQs and Troubleshooting
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="FAQs and Troubleshooting" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          FAQs and Troubleshooting
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faqs_and_troubleshooting/" class="md-nav__link">
        General Questions
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faqs_and_troubleshooting/installation_questions/" class="md-nav__link">
        Installation Questions
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../faqs_and_troubleshooting/troubleshooting/" class="md-nav__link">
        Troubleshooting
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      <label class="md-nav__link" for="__nav_6">
        Showcase
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Showcase" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Showcase
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../showcase/" class="md-nav__link">
        Leaf Deployment Showcase
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      <label class="md-nav__link" for="__nav_7">
        About
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="About" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          About
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/" class="md-nav__link">
        A Brief History
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/contributing/" class="md-nav__link">
        Contributing to Leaf
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/leaf_help_research/" class="md-nav__link">
        How can Leaf help biomedical research?
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../about/sponsor/" class="md-nav__link">
        Leaf Sponsors
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/uwrit/leaf/edit/master/docs/administration/concept_reference.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="concept-reference">Concept Reference<a class="headerlink" href="#concept-reference" title="Permanent link">¶</a></h1>
<h2 id="name-subtext-and-full-text">Name, Subtext, and Full Text<a class="headerlink" href="#name-subtext-and-full-text" title="Permanent link">¶</a></h2>
<p>Textual descriptions of Concepts are critical to making information about them clear to users. Leaf Concepts have three primary fields for describing information about them:
(<em>Concept fields referenced here are stored in the <code>app.Concept</code> database table unless otherwise noted</em>)</p>
<p align="center"><img src="../images/concept_name.png"/></p>

<ul>
<li><code>Name</code> - The primary text shown for the Concept within the tree. Try to keep this brief, leveraging parent Concepts above it to provide context and provenance where possible. This is stored in the database as <code>UiDisplayName</code>. </li>
<li><code>Subtext</code> - The smaller, lighter text shown to the right of the <code>Name</code>. This is optional, and we have found this works well for adding information such as how far back data in the Concept go. This is stored in the database as <code>UiDisplaySubtext</code>.</li>
</ul>
<p align="center"><img src="../images/concept_fulltext.png"/></p>

<ul>
<li><code>Full Text</code> - The text shown when a user drags the Concept over to create a query. We suggest making this a bit more verbose than <code>Name</code>, and approximating a sentence. This is stored in the database as <code>UiDisplayText</code>.</li>
</ul>
<h2 id="tooltips">Tooltips<a class="headerlink" href="#tooltips" title="Permanent link">¶</a></h2>
<p>Tooltips are a bit of a misnomer, as they are actually shown when the user clicks <code>Learn More</code> while hovering over a Concept, rather than just by hovering alone. </p>
<p align="center"><img src="../images/concept_tooltip.png"/></p>

<p><code>Tooltip</code> text can be used to provide detailed information to users about the data the Concept represents, but may be too long to put in the <code>Name</code> or <code>Subtext</code>. The text can be seen in the above example in the <code>Sources: Epic Clarity...</code> information. This is stored in the database as <code>UiDisplayTooltip</code>.</p>
<h2 id="patient-count">Patient Count<a class="headerlink" href="#patient-count" title="Permanent link">¶</a></h2>
<p align="center"><img src="../images/concept_patientcount.png"/></p>

<p>The <code>Patient Count</code> field shows a small green person indicating the number of unique patients the user would <em>expect</em> to find if she were to run a query with this Concept only and with no date restrictions, etc. </p>
<p>An example <code>stored procedure</code> to automatically loop through the <code>app.Concept</code> table and calculate this for each Concept is here <a href="https://github.com/uwrit/leaf/blob/master/src/db/obj/app.sp_CalculatePatientCounts.StoredProcedure.sql" target="_blank">https://github.com/uwrit/leaf/blob/master/src/db/obj/app.sp_CalculatePatientCounts.StoredProcedure.sql</a>, though please note that this will likely be scripted into an API or CLI-based procedure in the future.</p>
<p>This can be used by:</p>
<div class="highlight"><pre><span></span><code><span class="k">EXEC</span><span class="w"> </span><span class="n">app</span><span class="p">.</span><span class="n">sp_CalculatePatientCounts</span>
<span class="w">    </span><span class="o">@</span><span class="n">PersonIdField</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;person_id&#39;</span><span class="w">           </span><span class="c1">-- PersonId field for this Leaf instance</span>
<span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="n">TargetDataBaseName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;ClinDb&#39;</span><span class="w">         </span><span class="c1">-- Clinical database to query for this Leaf instance</span>
<span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="n">TotalAllowedRuntimeInMinutes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">180</span><span class="p">,</span><span class="w">   </span><span class="c1">-- Total minutes to allow to entire process to run</span>
<span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="n">PerRootConceptAllowedRuntimeInMinutes</span><span class="w"> </span><span class="c1">-- Total minutes to allow a given Root Concept</span>
<span class="w">                                           </span><span class="c1">-- and children to run,</span>
<span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="o">@</span><span class="n">SpecificRootConcept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">NULL</span><span class="w">            </span><span class="c1">-- Optional, specify a Root ConceptId to only </span>
<span class="w">                                           </span><span class="c1">-- recalculate counts for part of the tree</span>
</code></pre></div>
<p>This is stored in the database as <code>UiDisplayPatientCount</code>.</p>
<h2 id="numeric-filters">Numeric Filters<a class="headerlink" href="#numeric-filters" title="Permanent link">¶</a></h2>
<p>Use numeric filters to allow users to query based on a numeric value in your database.</p>
<p align="center"><img src="../images/concept_numeric1.gif"/></p>

<ol>
<li>
<p>Create a new Concept and set <code>Configuration</code> -&gt; <code>Is Numeric</code> to <code>true</code>.</p>
</li>
<li>
<p>Set the <code>Name</code> and <code>Full Text</code> fields in <code>General Display</code> as you normally would.</p>
</li>
<li>
<p>Fill in the <code>Numeric default text</code>, which is shown <em>after</em> the <code>Name</code> if the user has not filtered the Concept by any numeric value.</p>
</li>
<li>
<p>Optionally, set the <code>Units of measurement</code>, such as <code>years</code>, <code>kg</code>, etc.</p>
</li>
<li>
<p>Under <code>SQL</code>, set the <code>Numeric Field or expression</code> to the numeric column or expression that you'd like to query.</p>
</li>
</ol>
<p align="center"><img src="../images/concept_numeric2.gif"/></p>

<h2 id="adding-dropdowns">Adding Dropdowns<a class="headerlink" href="#adding-dropdowns" title="Permanent link">¶</a></h2>
<p>Dropdowns (also known as Concept <em>specializations</em>) allow users to optionally specify additional logic about a Concept to include in a query.</p>
<p>For example, imagine we have a <code>dbo.diagnosis</code> table that looks like this:</p>
<table>
<thead>
<tr>
<th>person_id</th>
<th>encounter_id</th>
<th>diag_date</th>
<th>coding_sys</th>
<th>diag_code</th>
<th>source</th>
<th>type</th>
</tr>
</thead>
<tbody>
<tr>
<td>A</td>
<td>123</td>
<td>2009-01-01</td>
<td>ICD10</td>
<td>E11.2</td>
<td>billing</td>
<td>primary</td>
</tr>
<tr>
<td>B</td>
<td>456</td>
<td>2005-08-10</td>
<td>ICD10</td>
<td>T02.5</td>
<td>radiology</td>
<td>secondary</td>
</tr>
<tr>
<td>B</td>
<td>789</td>
<td>2011-06-22</td>
<td>ICD10</td>
<td>A15.5</td>
<td>charges</td>
<td>primary</td>
</tr>
</tbody>
</table>
<p>We would probably create a Concept tree with a root <code>Diagnoses</code> Concept using the ICD10 hierarchy to allow users to run queries to find patients with certain diagnosis codes, such as type 2 diabetes mellitus.</p>
<p align="center"><img src="../images/concept_dropdown1.png"/></p>

<h3 id="problem-1">Problem 1<a class="headerlink" href="#problem-1" title="Permanent link">¶</a></h3>
<p><strong>What if users wanted to specify that the diagnosis must come from a specific source, such as <code>billing</code> or <code>radiology</code>?</strong></p>
<p>One approach to solve this would be to create child Concepts under <strong>every</strong> diagnosis Concept, with each child representing a diagnosis from a particular source:</p>
<p align="center"><img src="../images/concept_dropdown3.png"/></p>

<p>This works to a certain extent, though with every additional diagnosis source, we've doubled the number of diagnosis Concepts. Given that there are roughly 68,000 ICD-10 diagnosis codes as of this writing (not including their parent Concepts which represent ranges of codes), adding child Concepts for just the three example sources above, <code>billing</code>, <code>radiology</code>, and <code>charges</code> will add over 200,000 Concepts to our tree. Just as importantly, this solution may not necessarily be intuitive for users.</p>
<h3 id="problem-2">Problem 2<a class="headerlink" href="#problem-2" title="Permanent link">¶</a></h3>
<p><strong>What if we then wanted to also allow users to specify whether the diagnosis was <code>primary</code> or <code>secondary</code>?</strong></p>
<p align="center"><img src="../images/concept_dropdown4.png"/></p>

<p>We could simply add these as additional child Concepts, though users wouldn't be able to find patients who had this as the <code>primary</code> diagnosis <strong>and</strong> from <code>billing</code>.</p>
<p>Alternatively, we could create <code>primary</code> and <code>secondary</code> child Concepts under <strong>every</strong> <code>billing</code>, <code>radiology</code>, and <code>charges</code> Concept:</p>
<p align="center"><img src="../images/concept_dropdown5.png"/></p>

<p>Yikes. This creates a Cartesian product of all diagnosis sources and primary/secondary types <strong>for every diagnosis Concept</strong>. This is likely to be both confusing for users and wasteful in visual space (in the UI) and database storage.</p>
<h3 id="dropdowns-to-the-rescue">Dropdowns to the Rescue<a class="headerlink" href="#dropdowns-to-the-rescue" title="Permanent link">¶</a></h3>
<p align="center"><img src="../images/concept_dropdown6.gif"/></p>

<p>Dropdowns allow users to make the Concept logic more granular if they choose to, and do so in a visually intuitive way.</p>
<h3 id="creating-dropdowns">Creating Dropdowns<a class="headerlink" href="#creating-dropdowns" title="Permanent link">¶</a></h3>
<p align="center"><img src="../images/concept_dropdown7.gif"/></p>

<ol>
<li>
<p>Go to the <code>Admin</code> tab and click on any Concept. Under <code>SQL</code>, click <code>Table, View, or Subquery</code> -&gt; <code>Manage SQL Sets</code>.</p>
</li>
<li>
<p>Under the <code>SQL Set</code> you'd like to add a dropdown to, click <code>+Add New Dropdown</code> in the lower-left.</p>
</li>
<li>
<p>Under <code>Default Text</code>, add the text that should be shown if the user hasn't selected a dropdown option.</p>
</li>
<li>
<p>For each option you'd like to add, click <code>+Add Dropdown Option</code> and enter the <code>Text</code> that should be shown, as well as the <code>SQL WHERE</code> clause that should be appended to the Concept SQL if the user selects the option.</p>
</li>
<li>
<p>Click <code>Save</code> at the top.</p>
</li>
</ol>
<p>Because dropdowns are tied to <code>SQL Sets</code>, every Concept that uses that <code>SQL Set</code> is able to enable the dropdown as well, allowing dropdowns to be easily reused across many Concepts.</p>
<h3 id="enabling-dropdowns-for-a-concept">Enabling Dropdowns for a Concept<a class="headerlink" href="#enabling-dropdowns-for-a-concept" title="Permanent link">¶</a></h3>
<p align="center"><img src="../images/concept_dropdown8.gif"/></p>

<ol>
<li>
<p>After creating the dropdowns, in the <code>Admin</code> screen click the Concept you'd like to enable dropdowns for.</p>
</li>
<li>
<p>Under <code>Configuration</code>, make sure <code>Allow Dropdowns</code> is set to <code>true</code>.</p>
</li>
<li>
<p>Under <code>Dropdowns</code>, click each dropdown you'd like to enable. Enabled dropdowns will turn green and say "enabled!".</p>
</li>
</ol>
<div class="admonition info">
<p class="admonition-title">If you don't see any dropdowns available, under <code>SQL</code> make sure the Concept is using the same <code>SQL Set</code> as the dropdowns</p>
</div>
<ol>
<li>Click <code>Save</code> at the top.</li>
</ol>
<p>Users will now see the dropdown options when they drag over the Concept.</p>
<h2 id="restricting-access">Restricting Access<a class="headerlink" href="#restricting-access" title="Permanent link">¶</a></h2>
<p>Certain Concepts may represent sensitive data which you need to restrict access to, such as financial data.</p>
<p align="center"><img src="../images/concept_constraint.gif"/></p>

<p>To restrict access to certain users or groups:</p>
<ol>
<li>
<p>In the <code>Admin</code> screen, create a new Concept or click an existing Concept to edit.</p>
</li>
<li>
<p>Scroll down to <code>Access Restrictions</code> and click <code>+Add New Restriction</code>.</p>
</li>
<li>
<p>Select whether you'd like to give a specific <code>User</code> access or a <code>Group</code>.</p>
</li>
<li>
<p>Enter the <code>User</code> or <code>Group</code> name, making sure to include the Leaf <a href="../../../deploy/app/#issuer">Issuer</a> after the user name.</p>
</li>
</ol>
<p>Note that:</p>
<ul>
<li><strong>All child and descendent Concepts beneath the restricted Concept inherit the restriction.</strong></li>
<li><strong>If there are multiple restrictions, users need to meet only <em>one</em> of them in order to access the Concept.</strong></li>
<li><strong>Admins can always see all Concepts, whether restricted or not.</strong> </li>
</ul>
<h2 id="universal-ids">Universal IDs<a class="headerlink" href="#universal-ids" title="Permanent link">¶</a></h2>
<p>Universal IDs allow users to query multiple Leaf instances in a federated fashion (see <a href="../../../deploy/fed">Networking Multiple Leaf instances</a> to learn how this works).</p>
<p>Federated queries work by mapping the requesting user's local Concepts to the federated node's Concepts by <code>UniversalID</code>. <code>UniversalIDs</code> are defined using the <a href="https://tools.ietf.org/html/rfc2141" target="_blank">URN Syntax</a>.</p>
<div class="admonition info">
<p class="admonition-title">If you are only planning to query Concepts locally at your institution, you don't need to worry about setting <code>UniversalIDs</code></p>
</div>
<h3 id="mapping-universalids-at-query-execution">Mapping UniversalIds at Query Execution<a class="headerlink" href="#mapping-universalids-at-query-execution" title="Permanent link">¶</a></h3>
<p>Assuming multiple Leaf instances have exchanged certificates, user queries can be federated if:</p>
<ol>
<li>
<p>Every Concept involved in the user's query has a <code>UniversalId</code>, and</p>
</li>
<li>
<p>All federated Leaf instances have Concepts that match the <code>UniversalIds</code> used in the query.</p>
</li>
</ol>
<p>Because <code>UniversalIds</code> themselves are data-model agnostic and are simply a pointer to an arbitrary Concept, this functionality works even if federated Leaf instances use different data models.</p>
<div class="admonition info">
<p class="admonition-title">See <a href="https://www.youtube.com/watch?v=ZuKKC7B8mHI" target="_blank">https://www.youtube.com/watch?v=ZuKKC7B8mHI</a> for a working demonstration</p>
</div>
<h3 id="naming-conventions">Naming Conventions<a class="headerlink" href="#naming-conventions" title="Permanent link">¶</a></h3>
<p>A Concept representing Outpatient encounters could be defined with the <code>UniversalId</code>:</p>
<div class="highlight"><pre><span></span><code>urn:leaf:concept:encounter:type=outpatient
</code></pre></div>
<p>Or a Concept representing diagnosis codes for hypertension in pregnancy in ICD-10 could be:</p>
<div class="highlight"><pre><span></span><code>urn:leaf:concept:diagnosis:coding=icd10+code=O13.9
</code></pre></div>
<p>Note that these are simply examples, and you are free to define <code>UniversalIds</code> as you'd like. Perhaps the most important point though is to be sure that the <code>UniversalId</code> naming conventions for your Leaf instance and any other Leaf instances match exactly.</p>
<p align="center"><img src="../images/concept_universalid.png"/></p>

<p>You can find <code>UniversalIds</code> in the <code>Admin</code> panel under <code>Identifiers</code> -&gt; <code>UniversalId</code>. </p>
<blockquote>
<p>You don't need to preface <code>UniversalIds</code> with "urn:leaf:concept:" yourself, as Leaf will handle that for you.</p>
</blockquote>
<h3 id="univeral-ids-in-dropdowns">Univeral IDs in dropdowns<a class="headerlink" href="#univeral-ids-in-dropdowns" title="Permanent link">¶</a></h3>
<p align="center"><img src="../images/concept_specialization_universalid.gif"/></p>

<p>Note that <a href="#dropdowns-to-the-rescue">dropdown options</a> also use <code>UniversalIds</code> using the naming convention "urn:leaf:specialization:". If you are federating queries across multiple instances, <strong>make sure dropdowns similarly have <code>UniversalIds</code> defined</strong>.</p>
<h3 id="concepts-without-universal-ids">Concepts without Universal IDs<a class="headerlink" href="#concepts-without-universal-ids" title="Permanent link">¶</a></h3>
<p>There are inevitably scenarios where although you are federating your queries with other institutions, you still want to expose certain Concepts to your users that are unique to your local database and not expected to be found elsewhere.</p>
<p>Good news: That's okay!</p>
<p><strong>Leaf expects that not all clinical databases will be identical, and you shouldn't need to hide Concepts from your users simply because other institutions don't have the same data.</strong></p>
<p align="center"><img src="../images/concept_no_universalid.png"/></p>

<p>If a user uses one or more Concepts that are "local only" and don't have <code>UniversalIds</code>, Leaf will let them know which institutions weren't able to run the query.</p>
<h2 id="creating-concepts-by-sql-scripts">Creating Concepts by SQL Scripts<a class="headerlink" href="#creating-concepts-by-sql-scripts" title="Permanent link">¶</a></h2>
<p>Certain Concepts are inherantly hierarchical or voluminous enough that it makes more sense to programmatically add them, such as diagnosis or procedure codes. Head over to the Leaf Scripts repo at <a href="https://github.com/uwrit/leaf-scripts" target="_blank">https://github.com/uwrit/leaf-scripts</a> to see examples of how to do this.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
          </a>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Administration
            </div>
          </div>
        </a>
      
      
        <a href="../concepts/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              The Building Blocks of Leaf: Concepts
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/uwrit/leaf" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.top", "toc.integrate"], "search": "../../assets/javascripts/workers/search.fe42c31b.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.7353b375.min.js"></script>
      
    
  </body>
</html>